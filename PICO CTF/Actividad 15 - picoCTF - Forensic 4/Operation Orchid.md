Download this disk image and find the flag. Note: if you are using the webshell, download and extract the disk image into `/tmp` not your home directory.

- [Download compressed disk image](https://artifacts.picoctf.net/c/213/disk.flag.img.gz)
# Solución
Primero. `cd`al directorio `/tmp`. Luego, descargamos el archivo con `wget`. Averiguaremos cuál es el archivo de los metadatos usando el `file <file_name>`. Es una imagen de disco, así que vamos a descomprimirlo usando el `gunzip <file_name>`. Luego, se usa `ls`para consultar el contenido del archivo en el directorio actual. Estará la `disk.flag.img` que acabamos de descomprimir. A continuación, usaremos el `mmls` para averiguar el contenido de un disco. Básicamente, muestra el desplazamiento o el punto de partida de una partición en unidades de byte. Usaremos el comando con nuestra imagen de disco. Vemos que hay **dos** tabiques Linux (0x83). Puede que este en la quinta partición (índice 004) ya que tiene la mayor longitud, pero  estara en la tercera partición (índice 002).
Ahora, vamos a averiguar el contenido de una partición usando el `fls -o <starting offset>`. El Inode número 472 tiene la carpeta `root`. Por lo tanto, usando `fls` una vez más, pero ahora, tambien usando el inode number encontraremos flag.txt.enc en el inode 1782. En el inodo 1876, también hay una bandera.txt, pero como tiene un asterisco, ya se elimina. Ahora, desde el `.enc`archivo de extensión significa que el archivo está cifrado, debemos encontrar una manera de descifrarla también. Pero primero, tenemos que saber cuál es el método de cifrado que se utiliza y cuál es la clave para descifrarlo.
Vamos a ver qué `flag.txt.enc` se parece adentro usando el `icat` comando, para extraer los datos dentro. Para encontrar la llave, la encontraremos usando `strings -t d disk.flag.img | grep flag.txt`. Dejamos romper el comando: Tenemos un montón de salida en algunas líneas que se parecen `<number> <string>`. Los números representan las compensaciones de byte (en decimal) dentro de la imagen del disco donde se encontraron las cuerdas. Las cuerdas muestran acciones realizadas en un archivo llamado flag.txt.

Encontramos que se utilizó un cifrado OpenSSL AES-256 (como pensábamos), con opciones de salida con la clave `unbreakablepassword1234567`. Todo lo que queda es descifrarlo. Pero primero, vamos a extraer lo que está dentro usando el `icat`método para que podamos descifrar el contenido a la carpeta `/tmp`. Ahora el `flag.txt.enc` está en nuestra carpeta `/tmp` para que podamos hacerle algunos comandos. Aquí, vamos a descifrarlo usando el `unbreakablepassword1234567`.
`picoCTF{h4un71ng_p457_5113beab}`